# blog.by-hahn.com  
A Custom Static Publishing System by Byoungyoon Hahn

This repository contains the source code and build pipeline behind blog.by-hahn.com - my personal technical blog and long-term engineering project.

> A fully custom static site generator built from scratch - no frameworks, no runtime rendering, just a deliberate build-time architecture.

Live: **https://blog.by-hahn.com**

---

## Overview

This blog is a hand-written static site generator (SSG) - no Next.js, Gatsby, Hugo, or Jekyll. Every part of the pipeline, content parsing, HTML generation, sitemap production, and deployment, is implemented in a single Node.js build script (`scripts/build.js`).

The project began as a runtime-rendered blog: posts were fetched from the GitHub API at page load, parsed from Markdown in the browser, and injected into the DOM client-side. This worked for early iteration but failed on three axes that matter for a long-term technical publishing presence: SEO (crawlers saw empty shells), reliability (GitHub API rate limits), and performance (content required a network round-trip before first paint).

The current architecture moves all rendering to build time. The GitHub API is gone. Every post is a fully-formed, self-contained HTML file produced before any request is made. The browser receives a complete page from the first byte. This is the central trade-off of the project: build complexity was accepted in exchange for near-zero runtime complexity.

## Documentation

| Document | Contents |
|---|---|
| [**Architecture**](docs/architecture.md) | Build pipeline, template system, content model, security hardening |
| [**Build Pipeline**](docs/build-pipeline.md) | Build steps in detail, full `dist/` output tree, error handling |
| [**SEO & Performance**](docs/seo-strategy.md) | Meta tag strategy, sitemap, performance rationale |
| [**Lessons Learned**](docs/lessons-learned.md) | Engineering reflections, trade-offs, roadmap |
| [**Bug Log**](docs/bug_log.md) | Known issues, fixes, and regression notes |

## Features

- **Build-time rendering** - complete HTML output, no client-side content assembly
- **Markdown → HTML** via `markdown-it`, YAML frontmatter via `gray-matter`
- **Filename-driven URLs** - `YYYY-MM-DD~slug.md` determines date, slug, and sort order
- **Template system** - two HTML templates with inline and comment-style placeholder tokens
- **Auto-generated TOC** - h2/h3 extraction at build time; sticky sidebar on desktop, collapsible `<details>` on mobile, scroll spy via `requestAnimationFrame`
- **Featured posts** - frontmatter flag, highlighted homepage section (max 3)
- **Category system** - 8 fixed categories, index pages generated even when empty
- **Reading time** - estimated at build time (238 wpm), injected as static text
- **Dark/light theme** - `localStorage` + `prefers-color-scheme` fallback, no flash of wrong theme
- **Responsive layout** - 3-breakpoint pure CSS: desktop 2-column sidebar, tablet single-column, mobile hamburger nav
- **Per-post OG meta tags** - `og:title`, `og:description`, `og:url`, `og:image` at build time
- **Sitemap + robots.txt** - generated on each build
- **Security hardening** - HTML escaping, path traversal prevention, protocol blocking, `html: false` in markdown-it
- **GitHub Actions CI/CD** - push to `main` → build → deploy to `gh-pages`

## Tech Stack

| Layer | Technology |
|---|---|
| Build runtime | Node.js ≥ 20 |
| Markdown parsing | [markdown-it](https://github.com/markdown-it/markdown-it) |
| Frontmatter parsing | [gray-matter](https://github.com/jonschlinkert/gray-matter) |
| File system | [fs-extra](https://github.com/jprichardson/node-fs-extra) |
| File globbing | [glob](https://github.com/isaacs/node-glob) |
| Frontend | Vanilla HTML / CSS / JS |
| CI/CD | GitHub Actions |
| Hosting | GitHub Pages (custom domain via CNAME) |

## Project Structure

```
blog/
├── .github/workflows/deploy.yml   # CI/CD pipeline
├── CNAME                          # Custom domain: blog.by-hahn.com
├── package.json
├── scripts/
│   └── build.js                   # Entire SSG pipeline
├── posts/                         # Markdown source content
│   ├── activities/
│   ├── certifications/
│   ├── goals/
│   ├── guestbook/
│   ├── paper-reviews/
│   ├── posts/
│   ├── projects/
│   └── study-notes/
└── src/                           # Templates and static assets
    ├── 404.html
    ├── template-index.html
    ├── template-post.html
    └── assets/
        ├── css/main.css
        └── js/theme.js
```

Build output is written to `dist/` (generated by Actions at deploy time). See [Build Pipeline](docs/build-pipeline.md) for the full output tree.

## Getting Started

**Prerequisites:** Node.js ≥ 20, npm.

```bash
git clone https://github.com/by-hahn/blog.git
cd blog
npm ci
```

```bash
npm run build        # full rebuild → outputs to dist/
npx serve dist/      # serve locally on http://localhost:3000
```

The build is idempotent - a full rebuild on every run, no incremental state. There is no dev server; after any change, re-run `npm run build` and refresh.

## Writing a Post

Create a Markdown file under `posts/<category>/` with this filename format:

```
YYYY-MM-DD~slug.md
```

The date determines published order. The slug becomes the URL: `/category/slug/`. Both are derived from the filename - renaming the file is the canonical way to change a post's URL.

**Frontmatter** (all fields optional):

```yaml
---
title: "Post Title"            # Fallback: humanized slug
subtitle: "Optional subtitle"
description: "Summary text."  # Fallback: first paragraph of content
tags: ["engineering"]
featured: true                 # Promotes post to homepage featured section (max 3)
og_image: "https://..."        # Must be a valid https:// URL
og_title: "OG override title"  # Defaults to title
---
```

Raw HTML in post content is escaped, not rendered (`html: false` in markdown-it). Use only Markdown syntax.

## Deployment

Push to `main`. GitHub Actions checks out the repo, sets up Node.js 20 with npm caching, runs `npm ci` then `npm run build`, and deploys `dist/` to the `gh-pages` branch via `peaceiris/actions-gh-pages@v4`. Concurrency is set with `cancel-in-progress: true` to prevent parallel deploys. The `CNAME` value is written both in the repository root and in the deploy step to prevent GitHub from stripping it on redeploy.

The `gh-pages` branch is managed entirely by Actions - do not edit it manually.

---

## License

[MIT](LICENSE)

**Last updated:** February 21, 2026 | Based on commit: `0910735`
